res = 100;

p1 = Polynomial2D( [ ...
    0 -1 1 0.5; ...
    -1 0.1 0.5 0; ...
    1 0.5 0 0; ...
    0.5 0 0 0 ...
    ] );
%imtool( p1.draw( res ) );

p2 = Polynomial2D( [ ...
    0 -0.1 0 1; ...
    0.25 -1 0 0; ...
    -1 1 0 0; ...
    0 0 0 0 ...
    ] );
%imtool( p2.draw( res ) );

p3 = Polynomial2D( [ ...
    0.5 -0.25 1 1; ...
    0.25 -1 0 0; ...
    -1 1 0 0; ...
    -1 0 0 0 ...
    ] );
%imtool( p3.draw( res ) );

b1_p2_s_p3 = Body( p2, 'subtract', p3 );
%imtool( b1_p2_s_p3.draw( res ) );
b2_p1_u_b1 = Body( p1, 'unify', b1_p2_s_p3 );
%imtool( b2_p1_u_b1.draw( res ) );
im = b2_p1_u_b1.draw( res );
imtool( im );

% check single body
cc = bwconncomp( im, 4 );
single_body = cc.NumObjects == 1;

% check loads supported